% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nasalPkgFunctions.R
\name{prepare_data}
\alias{prepare_data}
\title{Align abundance and metadata, map timepoints, and normalize abundances per sample}
\usage{
prepare_data(abund, meta)
}
\arguments{
\item{abund}{Numeric matrix/data.frame of taxa x samples (columns are sample IDs).}

\item{meta}{Data frame of sample metadata with rownames as sample IDs and at least
\code{ATTRIBUTE_SynCom}, \code{ATTRIBUTE_Time}, and \code{ATTRIBUTE_Replicate}.}
}
\value{
A list with:
\itemize{
\item \code{meta}: aligned and augmented metadata data.frame.
\item \code{X}: numeric matrix of samples x taxa (relative abundances).
}
}
\description{
Prepares inputs for distance-based analyses by:
\itemize{
\item intersecting samples between an abundance table and a metadata table,
\item creating standardized metadata columns used downstream (sample/time/replicate/SynCom),
\item mapping time labels (T1, T2, T3, TF) to numeric order (1..4), and
\item producing a samples x taxa matrix normalized to relative abundances per sample.
}
}
\details{
\strong{Sample alignment}
Samples are kept in the intersection of \code{colnames(abund)} and \code{rownames(meta)}.
Metadata is reordered to match the abundance columns.

\strong{Time mapping}
\code{ATTRIBUTE_Time} must be one of \code{T1}, \code{T2}, \code{T3}, \code{TF}.
These are mapped to numeric order \code{1..4} and also stored as an ordered factor.

\strong{Normalization}
The abundance matrix is transposed to samples x taxa and normalized by row sums
(per-sample relative abundances). NAs are set to 0 and all-zero rows are protected
by replacing row sums of 0 with 1 before division.
}
\examples{
\dontrun{
prep <- prepare_data(abund = rel_abund_table, meta = md)
head(prep$meta)
dim(prep$X)  # samples x taxa
}

}

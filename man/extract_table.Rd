% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nasalPkgFunctions.R
\name{extract_table}
\alias{extract_table}
\title{Extract an agglomerated feature table from a phyloseq BIOM object}
\usage{
extract_table(biom_object, tax_rank, col_names)
}
\arguments{
\item{biom_object}{A \code{phyloseq} object (e.g., from \code{phyloseq::import_biom()}).}

\item{tax_rank}{Character. Taxonomic rank passed to \code{phyloseq::tax_glom()}
(e.g., \code{"Genus"}, \code{"Species"}).}

\item{col_names}{Character vector of taxonomy columns to unite into a single
\code{taxonomy} label (e.g., from \code{get_colNames_per_rank()}).}
}
\value{
A data.frame where the first column is \code{taxonomy} and remaining
columns are sample abundances.
}
\description{
Agglomerates a \code{phyloseq} object at a requested taxonomic rank, then
constructs a feature table that combines:
\itemize{
\item a single \code{taxonomy} label column (built by uniting selected taxonomy
ranks), and
\item the OTU/ASV abundance table.
}
}
\details{
Agglomeration is performed with \code{NArm = TRUE}, which removes taxa with
missing assignments at the chosen \code{tax_rank}.

The taxonomy label is built with \code{tidyr::unite(..., sep = "_")}, producing
labels such as \code{"Corynebacterium_propinq"} depending on your taxonomy table.
}
\examples{
\dontrun{
unite_cols <- get_colNames_per_rank("Species")
ft <- extract_table(biom_object, tax_rank = "Species", col_names = unite_cols)
head(ft)
}

}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nasalPkgFunctions.R
\name{filter_low_abundance}
\alias{filter_low_abundance}
\title{Filter low-abundance taxa based on maximum relative abundance}
\usage{
filter_low_abundance(rel_abundance, threshold = 0.01)
}
\arguments{
\item{rel_abundance}{Numeric matrix or data.frame with taxa as rows and samples
as columns, containing relative abundances (values typically in \code{[0, 1]}).}

\item{threshold}{Numeric. Minimum relative abundance required in at least one
sample for a taxon to be retained (default \code{0.01}, i.e., 1\%).}
}
\value{
A matrix/data.frame of the same type as \code{rel_abundance}, containing
only taxa whose maximum relative abundance meets or exceeds \code{threshold}.
}
\description{
Removes taxa (e.g., species/ASVs) whose relative abundance never reaches a
specified threshold in any sample. This is a simple prevalence/abundance
filter commonly used to reduce noise before ordination, clustering, or
differential abundance analyses.
}
\details{
For each taxon (row), the maximum relative abundance across all samples is
computed. Taxa with \code{max(abundance) < threshold} are removed.

Note that this filter:
\itemize{
\item is sensitive to single-sample spikes (a taxon is kept if it exceeds the
threshold in just one sample),
\item does not account for prevalence (number of samples above threshold).
}
Consider combining with prevalence-based filters if needed.
}
\examples{
\dontrun{
rel <- matrix(
  c(0.2, 0.1, 0.0,
    0.005, 0.002, 0.001,
    0.03, 0.04, 0.01),
  nrow = 3, byrow = TRUE,
  dimnames = list(c("Sp1","Sp2","Sp3"), c("S1","S2","S3"))
)

filtered <- filter_low_abundance(rel, threshold = 0.01)
}

}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nasalPkgFunctions.R
\name{merge_non_target_strains}
\alias{merge_non_target_strains}
\title{Merge non-target strains to species-level}
\usage{
merge_non_target_strains(df, target_species)
}
\arguments{
\item{df}{A numeric matrix or data.frame with strains in rows and samples
in columns. Row names are expected to contain species and strain
information, where the \strong{first two words} encode the species name
(e.g., "Corynebacterium propinquum 16").}

\item{target_species}{Character vector of species names (e.g.,
\code{"Corynebacterium propinquum"}) for which \strong{individual strains should be kept}.}
}
\value{
A data.frame where:
\itemize{
\item Rows corresponding to \code{target_species} remain at strain-level (unchanged).
\item All other strains are \strong{aggregated by species}, and each species is
represented by a single row whose name is \code{"<Genus> <species> 1"}.
}
}
\description{
Takes a strain-level feature (OTU) table and collapses all \strong{non-target}
strains to a single pseudo-strain per species, while keeping \strong{target}
strains unchanged.
}
\details{
Species names are derived from the row names by taking the first two words:
\code{paste(x[1:2], collapse = " ")} after splitting by spaces.

For non-target species:
\itemize{
\item All strain rows for a given species are summed across rows
\item The resulting aggregated row is named \code{"<Genus> <species> 1"} to preserve
compatibility with functions that expect a strain-like naming convention.
}

If there are no non-target strains, only the target strain rows are returned.
}
\examples{
\dontrun{
# Keep all strains of C. propinquum separate, merge all others by species
merged_df <- merge_non_target_strains(
  df = strain_table,
  target_species = c("Corynebacterium propinquum")
)
}
}

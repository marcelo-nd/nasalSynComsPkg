% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nasalPkgFunctions.R
\name{add_cluster_column}
\alias{add_cluster_column}
\title{Add a Cluster Column to a Metadata Data Frame}
\usage{
add_cluster_column(
  meta_df,
  clusters_df,
  meta_key_col,
  cluster_key_col,
  cluster_value_col,
  new_col_name,
  warn_missing = TRUE
)
}
\arguments{
\item{meta_df}{A data frame containing metadata. A key column within this
data frame will be used to map cluster values onto it.}

\item{clusters_df}{A data frame containing cluster assignments. Must include
a key column and a value column.}

\item{meta_key_col}{Character string. Name of the column in \code{meta_df}
used to match entries against \code{clusters_df}.}

\item{cluster_key_col}{Character string. Name of the key column in
\code{clusters_df} that corresponds to \code{meta_key_col}.}

\item{cluster_value_col}{Character string. Name of the column in
\code{clusters_df} containing the cluster labels or values to be mapped.}

\item{new_col_name}{Character string. Name of the new column to be added to
\code{meta_df} containing the mapped cluster entries.}

\item{warn_missing}{Logical. If \code{TRUE} (default), warns when some values
in \code{meta_df[[meta_key_col]]} have no corresponding match in
\code{clusters_df}.}
}
\value{
A modified version of \code{meta_df} containing a new column
\code{new_col_name} with mapped cluster values.
}
\description{
Maps cluster assignments from a lookup table onto a metadata data frame by
matching key columns. The function performs sanity checks, warns about
duplicated keys in the cluster table, optionally warns about metadata rows
with missing matches, and appends a new column containing the mapped cluster
values.
}
\details{
The function:
\itemize{
\item Checks that all required columns exist in both data frames.
\item Warns if duplicate keys appear in the cluster table; in such cases,
the last occurrence is used for mapping.
\item Constructs a named lookup vector mapping keys to cluster values.
\item Uses this lookup to assign cluster values to the metadata table.
\item Optionally warns about unmatched keys in the metadata.
}

This is a general-purpose utility for augmenting metadata with additional
annotations derived from separate data tables.
}
\examples{
\dontrun{
meta <- data.frame(Sample = c("S1", "S2", "S3"))
clusters <- data.frame(SampleID = c("S1", "S2"), Cluster = c(1, 2))

add_cluster_column(
  meta_df          = meta,
  clusters_df      = clusters,
  meta_key_col     = "Sample",
  cluster_key_col  = "SampleID",
  cluster_value_col = "Cluster",
  new_col_name     = "Cluster_Assignment"
)
}

}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nasalPkgFunctions.R
\name{load_biom_as_table}
\alias{load_biom_as_table}
\title{Load a BIOM file as a taxonomically agglomerated feature table}
\usage{
load_biom_as_table(
  biom_path,
  tax_rank = "Species",
  strain_taxonomy = FALSE,
  order_table = FALSE
)
}
\arguments{
\item{biom_path}{Character. Path to a \code{.biom} file containing a feature table
and taxonomy annotations (e.g., exported from QIIME2/HMP pipelines).}

\item{tax_rank}{Character. Taxonomic rank to aggregate to (default \code{"Species"}).
Must be a valid Greengenes rank string expected by your helper functions
(e.g., Kingdom/Phylum/Class/Order/Family/Genus/Species), otherwise downstream
helpers may error.}

\item{strain_taxonomy}{Logical. If \code{TRUE}, taxonomy strings are parsed with
\code{parse_taxonomy_strain} to preserve strain-level taxonomy conventions.
If \code{FALSE}, uses \code{phyloseq::parse_taxonomy_greengenes}.}

\item{order_table}{Logical. If \code{TRUE}, order rows from larger to smaller
mean abundance (typically via \code{rowMeans}) during cleaning.}
}
\value{
A cleaned abundance table (data frame) with taxa as rows and samples as
columns, ready for use in downstream analyses.
}
\description{
Imports a BIOM file (containing an OTU/ASV table and taxonomy), agglomerates
features to a requested Greengenes-style taxonomic rank (e.g., Genus/Species),
and returns a clean numeric table suitable for downstream ecological analyses
(e.g., \pkg{vegan}) and visualization (barplots/heatmaps).
}
\details{
The function:
\itemize{
\item validates/derives the expected taxonomy column names for \code{tax_rank}
(via \code{get_colNames_per_rank()})
\item imports the BIOM using \code{phyloseq::import_biom()}
\item parses taxonomy using either Greengenes defaults or a custom strain parser
\item agglomerates/aggregates the feature table at the requested rank
(via \code{extract_table()})
\item cleans the resulting table (unique rownames, optional ordering)
(via \code{clean_table()})
}

\strong{Output format}
The returned object is a data frame/matrix where:
\itemize{
\item rows correspond to aggregated taxa at \code{tax_rank}
\item columns correspond to samples
\item rownames are the taxon labels at \code{tax_rank} (dereplicated so they are unique)
}

The exact agglomeration and cleaning logic is delegated to project helper
functions \code{extract_table()} and \code{clean_table()}.
}
\examples{
\dontrun{
# Species-level table using Greengenes taxonomy parsing
tab_species <- load_biom_as_table(
  biom_path = "hmp_table.biom",
  tax_rank = "Species",
  strain_taxonomy = FALSE,
  order_table = TRUE
)

# Genus-level table with custom strain taxonomy parsing
tab_genus <- load_biom_as_table(
  biom_path = "hmp_table.biom",
  tax_rank = "Genus",
  strain_taxonomy = TRUE
)
}

}

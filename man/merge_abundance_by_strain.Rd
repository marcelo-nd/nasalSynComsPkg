% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nasalPkgFunctions.R
\name{merge_abundance_by_strain}
\alias{merge_abundance_by_strain}
\title{Map species-level abundances to strain-level abundances}
\usage{
merge_abundance_by_strain(df1, df2)
}
\arguments{
\item{df1}{A numeric matrix or data.frame with \strong{species-level abundances}.
Rows are species, columns are samples (e.g., "SC7_1", "SC7_2", ...).}

\item{df2}{A data.frame describing \strong{strain inoculation}. The first column
contains strain names (e.g., "Corynebacterium propinquum 16"), and the
remaining columns are SynCom IDs (e.g., "SC7", "SC12", ...) with values
0/1 indicating whether that strain was inoculated in that SynCom.}
}
\value{
A data.frame of strain-level abundances with:
\itemize{
\item rows = strains (from the first column of \code{df2})
\item columns = samples (same as \code{df1} column names)
}
}
\description{
Converts a species-level abundance table into a strain-level table using an
inoculation design matrix. For each sample, the abundance of a species in
\code{df1} is assigned to all strains of that species that were inoculated in the
corresponding SynCom (as specified in \code{df2}).
}
\details{
Species-strain mapping:
\itemize{
\item Species names in \code{df1} are expected to match the \strong{first two words} of the
strain names in \code{df2} (e.g., \code{"Corynebacterium propinquum"} in \code{df1}
matches \code{"Corynebacterium propinquum 16"} in \code{df2}).
\item Species names are extracted from strain names using the pattern
\verb{^([A-Za-z]+ [A-Za-z]+).*}.
}

Samples and SynComs:
\itemize{
\item Sample names in \code{df1} (columns) are assumed to follow the pattern
\code{"SCx_rep"} (e.g., \code{"SC7_1"}, \code{"SC7_2"}).
\item The SynCom ID used to query \code{df2} is obtained by taking the part before
the first underscore (e.g., \code{"SC7"} from \code{"SC7_1"}).
}

Strains whose species are not present in \code{df1} remain at zero.
}
\examples{
\dontrun{
# df1: species-level OTU/abundance table
# df2: inoculation design (first column = strains, other columns = SynComs)
strain_abundance <- merge_abundance_by_strain(df1 = species_abundance,
                                              df2 = inoculation_design)
}
}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nasalPkgFunctions.R
\name{.align_to_metadata}
\alias{.align_to_metadata}
\title{Align a metabolite feature table to sample metadata}
\usage{
.align_to_metadata(metab_df, metadata_df, sample_id_col = NULL)
}
\arguments{
\item{metab_df}{Metabolite feature table with metabolites as rows and samples as
columns. Column names must be sample IDs.}

\item{metadata_df}{Data frame containing sample metadata. Sample IDs are expected
either in \code{sample_id_col}, in a column named \code{Sample}, or as rownames.}

\item{sample_id_col}{Optional. Column name in \code{metadata_df} containing sample IDs.
If \code{NULL}, the function will use \code{Sample} if present; otherwise it will
fall back to rownames and create a \code{Sample} column.}
}
\value{
A list with:
\itemize{
\item \code{X}: numeric matrix of metabolites x aligned samples.
\item \code{meta}: metadata data.frame reordered to match \code{colnames(X)}.
}
}
\description{
Internal helper to subset and reorder a metabolite matrix/data frame so that
its sample columns match the sample ordering in the metadata. This is a common
prerequisite for ordination, regression, differential testing, and plotting.
}
\details{
The function:
\itemize{
\item locates sample IDs in \code{metadata_df} (either in \code{sample_id_col},
a \code{Sample} column, or rownames)
\item finds overlapping sample IDs between \code{colnames(metab_df)} and metadata
\item subsets \code{metab_df} to shared samples and converts it to a matrix
\item reorders \code{metadata_df} rows to match the metabolite matrix column order
}

If \code{sample_id_col} is \code{NULL} and \code{metadata_df} has no \code{Sample}
column, rownames(\code{metadata_df}) are used as sample IDs and copied into a new
\code{Sample} column. This makes downstream code more consistent.

Only samples present in both \code{metab_df} and \code{metadata_df} are retained.
The returned metadata is ordered to match the returned matrix columns.
}
\examples{
\dontrun{
out <- .align_to_metadata(metab_df = mat, metadata_df = md, sample_id_col = "Sample")
X  <- out$X
md <- out$meta
stopifnot(identical(colnames(X), rownames(md)))
}

}
\keyword{internal}
